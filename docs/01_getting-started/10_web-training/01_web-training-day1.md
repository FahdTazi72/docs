---
id: web-training-day1
title: Day 1
sidebar_label: Day 1
sidebar_position: 3

---
# Day 1 agenda
Reviewing the basics and extending our application​.

## Reviewing basic concepts
As introduced in the Developer Training, Genesis provides a modern future-proofed web stack on top of Microsoft FAST, which is a lightweight abstraction that enables you to easily ​build performant, memory-efficient, standards-compliant ​Web Components. 

Genesis also offers a highly configurable design system called Genesis Foundation UI. It is made up of a set of web components and accompanying design tokens. The visual design can be impacted in myriad ways using the tokens, CSS, element templates and shadow DOM options as necessary for your application.

This picture gives an overview on how it all ties together:

![](/img/WebUIDiagram.png)

:::tip confused with any term used here? Revisit the Developer Training!
Please feel free to revisit the UI chapter of the [Developer Training](/getting-stared/developer-training/developer-training-day2) before we get into other aspects of the underlying technology used by Genesis in the next sections.
:::

## A deeper dive into the alpha web application structure
The alpha application, the one we developed during the Developer training, had a basic UI with a simple page a few components. Open the project on your favorite IDE and you should see an initial project structure like this:

![](/img/web-project-structure.png)

:::note GenX
Remember that the initial project structure can be generated by GenX if you are starting from scratch.
:::

### The monorepo
This is a [lerna managed](https://lerna.js.org/) monorepo. One possible definition of a monorepo is a single repository containing multiple distinct projects, with well-defined relationships. In our case, it basically means your backend and frontend code will reside in the same repo in different folders. The web code is in the **client/web** folder. 

:::info 
Genesis components are standards-based Web Components, making them compatible with almost any modern web framework such as Angular, Reactor or Vue. 

Thus, it's important to note that under the client/web folder you can run pretty much any modern web framework you want, as long you set it up.

During this training, we are trying to be framework-agnostic but an Angular integration example will be given at the end of the course.
:::


### package.json file
In **client/web**, you'll also find a [package.json](https://nodejs.org/en/knowledge/getting-started/npm/what-is-the-file-package-json/) file. This file is used to give information to [npm](https://docs.npmjs.com/about-npm) that allows it to identify the project as well as handle the project's dependencies. It can also contain other metadata such as a project description, the version of the project in a particular distribution, license information or even configuration data. 

Looking deeper at our package.json, at the top you'll find the `name` and `description` of your application.

Following this, there are three key sections you need to be aware of:

- config
- scripts
- dependencies

#### Config

When running the app on your local machine, you can adjust a few settings under the `config` section, including which host to connect to and what port to run the dev server on.
```
"config": {
    "API_HOST": "ws://localhost/gwf/",
    "DEFAULT_USER": "JaneDee",
    "DEFAULT_PASSWORD": "beONneON*74",
    "PORT": 6061
  },
```

Since our backend is running locally, we set the API_HOST to localhost. The **/gwf/** path is a [reverse proxy](https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/) configured in a nginx web server running on the server (a WSL instance in our case). 

Essentially, the frontend will be connecting to the backend through a websocket to **localhost/gwf** which in turn will, internally, ***proxy pass*** the connection to an internal Genesis process called GENESIS_ROUTER that contains a web socket adapter able to communicate with other Genesis processes such as data servers, request servers, event handlers etc. Think of this as a gateway from the frontend to all services on the backend.


Alternatively, you can connect to **ws://localhost:9064** to bypass the proxy, but this is not encouraged for some reasons such as potential firewall issues.

:::tip
On your WSL server, the nginx configuration is at /etc/nginx/nginx.conf.
:::

#### Scripts

The next section is `scripts`.  

```javascript
  "scripts": {
    "build": "npm run build:webpack",
    "build:with-host": "cross-env API_HOST=$npm_package_config_API_HOST npm run build:webpack",
    "build:webpack": "cross-env NODE_ENV=production AUTO_CONNECT=true webpack",
    "clean": "npm run clean:dist",
    "clean:dist": "node ../.build/clean.js dist",
    "copy-files": "copyfiles -u 1 src/**/*.{css,scss,ttf} ./dist/esm",
    "dev": "npm run dev:webpack",
    "dev:webpack": "cross-env API_HOST=$npm_package_config_API_HOST AUTO_CONNECT=true DEFAULT_USER=$npm_package_config_DEFAULT_USER DEFAULT_PASSWORD=$npm_package_config_DEFAULT_PASSWORD NODE_ENV=development webpack serve --open",
    "serve": "serve dist -p $npm_package_config_PORT",
    "test": "echo \"Error: no test specified\""
  },
```

:::info
Your settings from the `config` block will be passed to different scripts as environment variables, using [cross-env](https://www.npmjs.com/package/cross-env).
:::

Also, note that we rely on [webpack](https://webpack.js.org/concepts/) to bundle the application. In **client/web** you'll find the ***webpack.config.js*** configuration file.

#### Dependencies

Last but not least, the `dependencies` section contains a list of your app's dependencies and their versions.

:::info
This includes **@genesislcap** dependencies. This is where you would change their versions to upgrade to a newer version of the platform.
:::


```javascript
  "dependencies": {
    "@genesislcap/foundation-comms": "1.0.0",
    "@genesislcap/foundation-entity-management": "1.0.0",
    "@genesislcap/foundation-login": "1.0.0",
    "@genesislcap/foundation-utils": "1.0.0",
    "@genesislcap/foundation-zero": "1.0.0",
    "@genesislcap/foundation-ui": "1.0.0",
    "@microsoft/fast-components": "^2.16.6",
    "@microsoft/fast-element": "^1.6.2",
    "@microsoft/fast-foundation": "^2.27.1",
    "@microsoft/fast-router": "^0.2.11",
    "@microsoft/fast-web-utilities": "^5.0.1",
    "rxjs": "^7.4.0",
    "tslib": "^2.3.1"
  }
```

:::tip
You can use the `lerna add` command (instead of `npm install`) if you need to add more dependencies, since the app is a [lerna managed](https://lerna.js.org/) monorepo.
:::

### Web pages
To view or use your Genesis application, you need to create one or more web pages. On each of these pages, you need to have components that display information or enable the user to interact with the application.

In the Developer Training, we amended these files in the **client/web/src/routes/home** folder:
-	**home.template.ts**
-	**home.ts**
-	**home.styles.ts**

Realistically, any application will require multiple pages and routes. 

If you're not familiar with the concept of [routing](https://developpaper.com/question/what-is-front-end-routing-when-is-front-end-routing-appropriate-what-are-the-advantages-and-disadvantages-of-front-end-routing/), it's basically displaying different content or pages according to different URL addresses. In this context, it means that different routes correspond to different contents or pages to the front-end, which is realized by the server returning different pages according to the different URLs. In single-page applications, most pages are structurally unchanged and only part of the content is changed.

## Extending our application
### What are we going to build
Hopefully this introduction was enough to recap the basic concepts and introduce some of the web technologies we rely on. 

To get started on the implementation of our web app, these are the features we're going to build during the training:
-   **a proper navigation menu**
-   **a complex order entry screen using multiple components offered by the Genesis UI**
-   **reporting capabilities**
-   **user and profile management**
-   **orders and positions advanced data grids with filters and searching**

Some of the non-functional requirements we're going to address along with the implementation of the app:
-   **override a design system to promote brand alignment and a reusable component library**
-   **components styling**
-   **async communication with the server with Genesis Comms**
-   **Angular integration**

Now, let's get down to business!

### Adding the navigation menu

Let's use the Header micro front-end to add a simple and nice navigation menu to our application. The Header micro front-end is a semi-batteries included component that consists of a navigation bar and flyout menu, with routing and account logout capabilities.

You can customise:

- the icon shown on the navigation bar and flyout menu (this shows the Genesis logo by default).
- navigation links at the left-hand side of the navigation bar.
- the control buttons on the right-hand side of the navigation bar can be shown or hidden, and their behaviour controlled via event listeners
- The contents of the flyout menu.

Here is an example of the navigation bar with three navigation items, and all three control buttons shown.
![Header with the standard genesis logo](/img/foundation-header-standard.png)

This next example is the same as the previous example, except the Genesis logo is replaced with a custom icon.
![Header with a customised logo](/img/foundation-header-replaced-img.png)

In this next example, we have put a set of example options set in the flyout menu.
![The sidebar included with the header opened with some example content](/img/foundation-header-sidebar.png)

#### Header Set-up

To enable this micro front-end in our application, follow the steps below.

- Add `@genesislcap/foundation-header` as a dependency in your *package.json* file. Whenever you change the dependencies of your project, ensure you run the bootstrap command again.

```javascript
{
  ...
  "dependencies": {
    "@genesislcap/foundation-header": "latest"
  },
  ...
}
```

- In our **web/src/main/main.ts** file, which is our top level class of our application, import and dependency inject the Navigation class.
```javascript
import { Navigation } from '@genesislcap/foundation-header';

@customElement({ name, template, styles })
export class MainApplication extends FASTElement {
  @inject(MainRouterConfig) config!: MainRouterConfig;
  @inject(Navigation) navigation!: Navigation;

	...

}
```

- Set a reference to the `navigation` object on the FAST router when you instantiate it, this will allow us to set up navigation functionality from the navigation bar in the [navigation items step.](#navigation-items)
```javascript
// fast-router will likely have other attributes such as :config too
const MainTemplate: ViewTemplate<MainApplication> = html`
  <fast-router :navigation=${(x) => x.navigation}></fast-router>
`;
```

- Add the `foundation-header` tag as part of the html that you set as the markup for the `defaultLayout` in your router configuration.
```javascript
export const defaultLayout = new FASTElementLayout(html`
<div class="container">
	<!-- show-luminance-toggle-button boolean attribute added to show that button on the navigation bar -->
	<foundation-header show-luminance-toggle-button></foundation-header>
	<!-- Other markup -->
</div>`);

export class MainRouterConfig extends RouterConfiguration<LoginSettings> {

	...

	public configure() {
		this.title = 'Example app';
		this.defaultLayout = defaultLayout;
		...
	}
}
```

#### Customising the header

##### Icon

By default, the navigation bar and flyout menu show the Genesis logo. You can override this by setting the `logoSrc` attribute. For example:

```html
<foundation-header logoSrc="https://icotar.com/avatar/genesis"></foundation-header>
```
The `logoSrc` defines the image that you want to display. Adding this attribute will update the logo on both the flyout and navigation bar. Omit the attribute to leave the Genesis logo.

##### Navigation items

You can add navigation items can be added to the left-hand side of the navigation bar. For each element, you can set `slot="routes"` attribute, so that navigation is controlled via a `@click` event. The following is a really basic example for adding a 'Home' button:

```javascript
html`
<foundation-header
	<zero-button
		slot="routes"
		value="1"
		@click=${(x, c) => c.parent.navigation.navigateTo("home")}
	>Home</zero-button>
></foundation-header>`;
```
The `navigation` object referenced via the `parent` object is why the `navigation` object is added as an attribute to the `fast-router` in the [setup step](#header-setup). From it, the `navigateTo` method can be called, which allows the user to navigate around the finished application from the navigation buttons.

Moving on from this basic example, a dynamic set of routes can be configured, using the `repeat` directive from FAST.

- Add the routes configuration into an array in the router configuration class.
```javascript
export class MainRouterConfig extends RouterConfiguration<LoginSettings> {

	// New configuration added to existing MainRouterConfig class
	public allRoutes = [
		{ index: 1, path: 'protected', title: 'Home', icon: 'home', variant: 'solid' },
		{ index: 2, path: 'admin', title: 'Admin', icon: 'cog', variant: 'solid' },
		{ index: 3, path: 'reporting', title: 'Reporting', variant: 'solid' },
	];

	...
}
```

- When setting the navigation items, use the `repeat` directive to iterate over the defined routes and create a navigation item for each.

The following example creates a button with an associated logo for each of the three defined routes:

```javascript
html`
<foundation-header
	${repeat(
		(x) => x.config.allRoutes,
		html`
			<zero-button
				appearance="neutral-grey"
				slot="routes"
				value="${(x) => x.index}"
				@click=${(x, c) => c.parent.navigation.navigateTo(x.path)}
			>
				<zero-icon variant="${(x) => x.variant}" name="${(x) => x.icon}"></zero-icon>
				${(x) => x.title}
			</zero-button>
		`
	)}
></foundation-header>`;
```

##### Control buttons

There are three control buttons that can be shown or hidden on the right-hand side of the navigation bar (these are hidden by default). Each one of them is a boolean attribute that can be added where the `<foundation-header>` tag is defined. Each one dispatches an associated event when clicked.

| Logo          | Toggle Attribute             | Dispatched Event          |
|---------------|------------------------------|---------------------------|
| Moon          | show-luminance-toggle-button | luminance-icon-clicked    |
| Misc          | show-misc-toggle-button      | misc-icon-clicked         |
| Notifications | show-notification-button     | notification-icon-clicked |

Implementing the functionality of the buttons is up to the client. For example:

- Define the functionality of the event callback in the class of a class which is a parent to the router.

```javascript
export class MainApplication extends FASTElement {

	onMiscButtonPressed() {
		// ... do something
	}
	...
}
```

- Set the event listener in the parent html to call the defined functionality.
```javascript
// fast-router will likely have other attributes such as :config too
const MainTemplate: ViewTemplate<MainApplication> = html`
  <fast-router
		:navigation=${(x) => x.navigation}
		@misc-icon-clicked=${(x) => x.onMiscButtonPressed()}
	>
	</fast-router>
`;
```

##### Menu contents

To set the content of the flyout menu, add the content in the html within an element that has the `slot="menu-contents"` attribute.
```html
<foundation-header>
	<div slot="menu-contents">
		<!-- Example markup -->
		<p>GROUP SLOT</p>
		<zero-tree-view>
			<zero-tree-item>
				<zero-icon variant="solid" name="location-arrow"></zero-icon>
				Slot Tree Item
			</zero-tree-item>
			<zero-tree-item>
				<zero-icon variant="solid" name="location-arrow"></zero-icon>
				Slot Tree Item
			</zero-tree-item>
		</zero-tree-view>
		<p>GROUP SLOT 2</p>
		<zero-tree-view>
			<zero-tree-item>
				<zero-icon variant="solid" name="location-arrow"></zero-icon>
				Slot Tree Item 2
			</zero-tree-item>
			<zero-tree-item>
				<zero-icon variant="solid" name="location-arrow"></zero-icon>
				Slot Tree Item 2
			</zero-tree-item>
		</zero-tree-view>
	</div>
</foundation-header>
```

### Exercise 1.1: customizing the header
:::info estimated time
45min
:::
Customize our header in such a way that we end up with these menu items:

| Menu item          | Route             |
|---------------|------------------------------|
| Trades & Positions          | home |
| Order entry          | order-entry |
| Reporting          | reporting      |

Feel free to simply display the same content of the home page when you create the new pages (Order Entry and Reporting). We're just interested in the navigation for now.

:::tip 
You can copy the home folder into new folders to create the new pages. 

Also, make sure to configure `client/web/src/main/main.ts` and `client/web/src/routes/config.ts` accordingly.
:::